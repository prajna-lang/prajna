// 测试单独的 Nuklear C 函数调用
use examples::nuklear::*;

func Main() {
    "=== Nuklear C 函数测试 ===".PrintLine();
    
    // 1. 先测试简单的颜色函数（不需要上下文）
    "1. 测试颜色创建函数...".PrintLine();
    var red = nk_rgb(255i32, 0i32, 0i32);
    "   ✓ nk_rgb 调用成功: r=".Print(); red.r.PrintLine();
    
    var blue_alpha = nk_rgba(0i32, 0i32, 255i32, 128i32);
    "   ✓ nk_rgba 调用成功: b=".Print(); blue_alpha.b.Print(); ", a=".Print(); blue_alpha.a.PrintLine();
    
    // 2. 测试哈希函数
    "2. 测试哈希函数...".PrintLine();
    var test_str = "Hello";
    var cstr = test_str.CStringRawPointer();
    var len = test_str.Length().Cast<i32>();
    var hash = nk_murmur_hash(bit_cast<ptr<char>, ptr<undef>>(cstr), len, 0u32);
    "   ✓ nk_murmur_hash 调用成功: ".Print(); hash.PrintLine();
    
    // 3. 测试上下文初始化（在独立作用域中）
    "3. 测试上下文初始化...".PrintLine();
    {
        var ctx: nk_context;
        var memory: array<char, 4096>;
        
        "   尝试调用 nk_init_fixed...".PrintLine();
        var result = nk_init_fixed(&ctx, bit_cast<ptr<char>, ptr<undef>>(&memory[0]), 4096u64, ptr<undef>::Null());
        "   ✓ nk_init_fixed 返回值: ".Print(); result.PrintLine();
        
        if (result != 0i32) {
            "   ✓ Nuklear 上下文初始化成功！".PrintLine();
            
            // 4. 测试清理函数
            "4. 测试清理函数...".PrintLine();
            nk_free(&ctx);
            "   ✓ nk_free 调用成功".PrintLine();
        } else {
            "   ✗ Nuklear 上下文初始化失败".PrintLine();
        }
        
        "   离开上下文作用域...".PrintLine();
    }
    
    "5. 上下文作用域已结束".PrintLine();
    
    "=== C 函数测试完成 ===".PrintLine();
}
