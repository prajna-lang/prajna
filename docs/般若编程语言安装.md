
## 安装

### 下载源码和依赖库

首先我们下载源码, 下载的库会比较多, 如果没有报错请耐心等待, 需要配置网络代理以便能流畅下载github的代码

```bash
# 下载代码
git clone https://github.com/matazure/prajna.git
# 下载依赖库
./scripts/clone_submodules.sh --jobs=16 --depth=100
```

如果在下载的代码中出现错误可以自行处理出了问题的submodule, 主要原因是depth的深度不能包含所需的commit.
建议加大depth的深度或者直接执行

```bash
./scritps/clone_submodules.sh --force
```

### 进入docker环境

我们这里使用docker的环境来编译代码, 也可以自行参阅[dockerfile](../dockerfiles/ubuntu_dev.dockerfile)等文件来配置环境.
值得注意的是目前Prajna只支持Clang的编译器, 若使用GCC或其他编译器肯能需要自己适配.

```bash
./scripts/start_docker_env.sh
```

### 配置

```bash
# 配置release版本的cmake, 如果想要使用gpu版本, 则需要在有cuda环境的机器里开启-DPRAJNA_WITH_GPU=ON.
./scripts/configure.sh release -DPRAJNA_WITH_GPU=OFF
```

### 编译

``` bash
# 编译代码
./scripts/build.sh release
```

般若编程语言依赖llvm, 我们最好直接安装相同版本的llvm.

```bash
cd build_release/third_party/llvm-project/llvm
make install
cd -
# 可以不用拷贝安装, 将build_release/install/bin的路径加入到可执行路径里即可
sudo cp -r build_release/install/* /usr
```

## 执行

般若可以通过下面指令进入命令行模式

```bash
./build_release/bin/prajna repl
```

还可以通过prajna文件直接执行, 需要文件里包含一个main函数, 可参阅tests/program/main.prajna

```bash
./build_release/bin/prajna exe tests/program/main.prajna
```

除此之外还可以通过[jupyter](https://jupyter.org/)执行, 通过下面指令安装jupyter kenerl. 若需要jupyter支持, 在配置是需要打开Jupyter选项重新编译. Jupyter的环境安装可自行查阅, docker里是不带的, 建议直接使用本机环境配置编译.
```bash
./scripts/configure.sh release -DPRAJNA_WITH_JUPYTER=ON
```

```bash
./prajna jupyter --install
```
